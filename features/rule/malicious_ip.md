# Malicious IP Blocking

Malicious IP blocking allows UWAF to automatically impose penalties on the source IP of attack requests, i.e., adding the IP to the domain's blacklist for blocking, after the current domain has been attacked multiple times from a single IP within a certain period. If there is a third-party proxy in front, it may cause misblocking without obtaining the accurate source IP.

Malicious IP blocking is controlled by the blacklist and whitelist status, and only takes effect when the blacklist and whitelist status is turned on.

![](/images/malicious_ip-get_rule.png)

> For the priority of various rules, please refer to [Rule Priority](/uewaf/features/rule/mode?id=Rule Priority).

!> Note:  
The malicious IP function depends on the [Domain Blacklist](/uewaf/features/expand/black_list) rule. The principle is that UWAF counts the attack requests of a certain IP and automatically generates blacklist rules. The rules may take effect with a delay, and the actual effective time shall prevail. You can view the IPs blocked by the malicious IP blocking rule in [Function Settings] -> [IP Management] -> [[Blacklist](/uewaf/features/expand/black_list)]. The IPs added to the blacklist by triggering the malicious IP blocking rule are added by the "automatic interception rule".

## Add Rule

You can add rules based on the attack type and attack frequency. When a rule with the attack type "all" is added, no other attack type blocking rules can be added; when a specific attack type rule is added, no "all" type blocking rules can be added.

![](/images/malicious_ip-add_rule.png)

### Rule Parameter Description

| Parameter         | Description                                                  |
| ----------------- | ------------------------------------------------------------ |
| Statistics Period | The period for counting attack requests                      |
| Attack Type       | Counting which specified attack types, default is all, only one rule of all types can be set, and only one rule of different attack types can be set |
| Threshold         | The number of attack requests of a specific attack type      |
| Blocking Duration | After joining the blacklist, the effective time of the blacklist |

> Attack request definition: Requests that trigger the default UWAF rules and custom UWAF rules (excluding user-defined pass rules) and requests that trigger CC rules (excluding subsequent interception requests).																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																									

â€‹																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																									
